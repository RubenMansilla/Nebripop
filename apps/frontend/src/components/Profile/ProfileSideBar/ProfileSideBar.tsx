import { useNavigate, useLocation } from "react-router-dom";
import { useContext, useEffect, useState } from "react";
import { AuthContext } from "../../../context/AuthContext";
import type { ReviewSummary } from "../../../types/review";
import { reviewSummaryStore } from "../../../store/reviewSummaryStore";
import { getReviews } from "../../../api/reviews.api"; // <--- IMPORTANTE: Importa tu API aquí
import './ProfileSideBar.css';

export default function ProfileSideBar() {

    const navigate = useNavigate();
    const location = useLocation();
    const { user } = useContext(AuthContext);

    const defaultPic = "https://zxetwkoirtyweevvatuf.supabase.co/storage/v1/object/sign/userImg/Default_Profile_Picture.png?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV9kYWMwYTY1NC1mOTY4LTQyNjYtYmVlYy1lYjdkY2EzNmI2NDUiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJ1c2VySW1nL0RlZmF1bHRfUHJvZmlsZV9QaWN0dXJlLnBuZyIsImlhdCI6MTc2NDU4MzQ3OSwiZXhwIjoxNzk2MTE5NDc5fQ.yJUBlEuws9Tl5BK9tIyMNtKp52Jj8reTF_y_a71oR1I";

    if (!user) return null;

    const year = new Date(user.createdAt).getFullYear();

    // Foto del usuario o por defecto en caso de no tener
    const imageSrc = user.profilePicture || defaultPic;

    // Resumen de valoraciones del usuario
    const [summary, setSummary] = useState<ReviewSummary>({ average: 0, total: 0 });

    useEffect(() => {
        if (!user) return;

        // 1. COMPROBAR DATOS EN CACHÉ (STORE)
        const cachedData = reviewSummaryStore.value;
        const hasValidData = cachedData && cachedData._userId === user.id;

        if (hasValidData) {
            // A: Si tenemos datos válidos del usuario actual, los usamos ya.
            setSummary(cachedData);
        } else {
            // B: Si NO hay datos o son de otro usuario, reseteamos a 0 visualmente...
            setSummary({ average: 0, total: 0 });

            // ... Y HACEMOS EL FETCH AQUÍ MISMO PARA CALCULARLOS
            getReviews(user.id, "newest") // O el filtro que uses por defecto
                .then((data) => {
                    const total = data.length;
                    // Evitar división por cero
                    const avg = total > 0
                        ? data.reduce((acc: any, r: any) => acc + r.rating, 0) / total
                        : 0;

                    const newSummary = { average: avg, total };

                    // Actualizamos el estado local
                    setSummary(newSummary);

                    // Actualizamos el store global para que otras partes (y la caché) se enteren
                    reviewSummaryStore.set(newSummary, user.id);
                })
                .catch(err => console.error("Error cargando resumen de reviews:", err));
        }

        // 2. SUSCRIPCIÓN (Para que si ReviewProfile actualiza algo, la barra lateral se entere)
        const unsub = reviewSummaryStore.subscribe((v) => {
            // Solo actualizamos si el ID coincide (o si el store maneja eso internamente)
            if (reviewSummaryStore.value?._userId === user.id) {
                setSummary(v);
            }
        });

        return () => unsub();
    }, [user]);

    const starClass = (n: number) => {
        return n <= summary.average ? "filled" : "";
    };


    return (
        <>
            <div className='sidebar-left'>
                <div className={`sidebar-profile ${(location.pathname === "/profile/info" || location.pathname === "/profile/reviews") ? "active" : ""}`} onClick={() => navigate("/profile/info")}>
                    <div className="profile-pic">
                        <img src={imageSrc} alt="Foto de perfil" />
                    </div>
                    <div className="profile-info">
                        <div className="profile-name">
                            <h3>{user.fullName.split(" ")[0]}</h3>
                        </div>
                        <div className="profile-rating">
                            <div className="stars-summary">
                                {[1, 2, 3, 4, 5].map(n => (
                                    <svg
                                        key={n}
                                        className={`star ${starClass(n)}`}
                                        viewBox="0 0 24 24"
                                    >
                                        <path d="M11.074 2.633c.32-.844 1.531-.844 1.852 0l2.07 5.734a.99.99 0 0 0 .926.633h5.087c.94 0 1.35 1.17.611 1.743L18 14a.97.97 0 0 0-.322 1.092L19 20.695c.322.9-.72 1.673-1.508 1.119l-4.917-3.12a1 1 0 0 0-1.15 0l-4.917 3.12c-.787.554-1.83-.22-1.508-1.119l1.322-5.603A.97.97 0 0 0 6 14l-3.62-3.257C1.64 10.17 2.052 9 2.99 9h5.087a.99.99 0 0 0 .926-.633z" />
                                    </svg>
                                ))}
                            </div>
                            <span>({summary.total})</span>
                        </div>
                        <div className="profile-creation">
                            <span>En Nebripop desde {year}</span>
                        </div>
                    </div>
                    <div className="arrow">
                        <svg xmlns="http://www.w3.org/2000/svg" width="128" height="128" viewBox="0 0 24 24"><path fill="#000000" d="m14.475 12l-7.35-7.35q-.375-.375-.363-.888t.388-.887t.888-.375t.887.375l7.675 7.7q.3.3.45.675t.15.75t-.15.75t-.45.675l-7.7 7.7q-.375.375-.875.363T7.15 21.1t-.375-.888t.375-.887z" /></svg>
                    </div>
                </div>
                <div className="sidebar-menu">
                    <div className={`menu-item ${(location.pathname === "/purchases/ongoing" || location.pathname === "/purchases/completed") ? "active" : ""}`} onClick={() => navigate("/purchases/ongoing")}>
                        <svg width="27" height="23" viewBox="0 0 27 23" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M24.3416 11.4886L19.7164 7.76434L16.9779 5.50465L16.9742 5.50095C15.9084 4.62218 14.8155 4.72434 13.9441 5.41972C13.748 5.57215 13.574 5.75109 13.4271 5.95141C11.9441 7.68188 10.3478 8.36988 8.94099 8.21603C8.59629 8.18208 8.26297 8.0742 7.96376 7.89972C8.9376 7.06435 9.70187 6.01216 10.1951 4.82772C10.4767 4.14113 10.8913 3.51706 11.4152 2.9915C11.939 2.46594 12.5618 2.04929 13.2475 1.76557C14.5225 1.2388 16.0561 1.26957 17.6167 1.7828L17.9195 1.89111C18.7958 2.1988 19.3422 2.36249 19.9428 2.45972L19.9798 2.46464C23.0001 2.93603 25.1244 5.28557 25.1244 8.28249C25.1244 9.60926 24.8831 10.584 24.3416 11.4886ZM24.2075 14.2923L23.8431 14.7219C23.5453 15.0702 22.957 15.0911 22.5262 14.7231L22.2358 14.3982C22.1509 14.2854 22.0566 14.18 21.9539 14.0831L21.9145 14.0376L21.9121 14.04C21.8899 14.0191 21.8727 13.9945 21.8493 13.9748C21.1921 13.4136 20.3071 14.3231 20.8868 14.9643L21.0345 15.1268C21.3767 15.496 21.4296 16.0068 21.1564 16.328L20.7896 16.7576C20.4918 17.1059 19.9035 17.1268 19.4727 16.76L19.1822 16.4339C19.0974 16.3207 19.0031 16.2149 18.9004 16.1176L18.861 16.072L18.8598 16.0745C18.8376 16.0536 18.8191 16.029 18.7982 16.0105C18.1385 15.448 17.2548 16.3588 17.8333 16.9988L17.981 17.1637C18.3231 17.5305 18.3761 18.0437 18.1028 18.3637L17.7373 18.792C17.4382 19.1403 16.8487 19.1613 16.4191 18.7945C16.4191 18.7945 15.6598 18.253 15.5576 18.1545C15.5576 18.1545 15.4739 18.0646 15.4518 18.045C14.7933 17.4837 14.0561 18.3933 14.6345 19.0357L14.8561 19.1994C15.197 19.5674 15.2868 20.0794 15.0136 20.3982L14.6665 20.8277C14.3687 21.176 13.789 21.197 13.357 20.8302C13.1871 20.7071 13.1908 20.7071 12.8364 20.4585L12.6715 20.3403C12.9503 19.6083 13.0001 18.8088 12.8142 18.0478C12.6282 17.2868 12.2153 16.6003 11.6302 16.0794L6.2813 11.32C5.24376 10.3957 3.74591 10.1434 2.42899 10.509C2.17791 9.78649 2.01299 9.03572 2.01299 8.28249C2.01299 7.4596 2.17511 6.64478 2.49009 5.88456C2.80507 5.12434 3.26674 4.43362 3.84872 3.85187C4.43071 3.27011 5.1216 2.80872 5.88195 2.49403C6.64229 2.17935 7.45718 2.01755 8.28007 2.01788C8.93237 2.01788 9.56007 2.14957 10.1681 2.3428C9.64498 2.92147 9.22196 3.58325 8.91637 4.30095C8.45567 5.42568 7.70219 6.40652 6.73422 7.14157C6.07453 7.64618 6.32437 8.40065 6.9336 8.89172C7.38407 9.25234 8.04868 9.50957 8.78837 9.5908C10.669 9.79757 12.7071 8.91757 14.5176 6.80065C14.5915 6.70218 14.6801 6.60126 14.8068 6.50034C15.2056 6.1828 15.5822 6.14834 16.0918 6.5668C16.0918 6.5668 16.0942 6.56803 16.0942 6.57049L18.8413 8.83511L24.0204 13.005C24.4339 13.3594 24.5065 13.944 24.2087 14.2923M10.9176 20.6308L10.8918 20.6616C10.7528 20.818 10.5577 20.9133 10.3489 20.9267C10.1401 20.94 9.93444 20.8704 9.77668 20.733L1.66099 13.6905C1.58178 13.6214 1.51701 13.5373 1.4704 13.4431C1.42379 13.3489 1.39626 13.2464 1.3894 13.1415C1.38254 13.0367 1.39647 12.9314 1.43041 12.832C1.46435 12.7325 1.51761 12.6407 1.58714 12.5619L1.60068 12.5459C2.5016 11.5342 4.33053 11.4345 5.36314 12.3526L10.7133 17.112C11.741 18.0265 11.8333 19.6019 10.9176 20.6308ZM26.509 8.28249C26.509 4.58772 23.8715 1.6708 20.1927 1.09849L20.1644 1.09357C19.6671 1.01357 19.1835 0.869567 18.3822 0.58649C18.2222 0.529875 18.0795 0.529875 17.9195 0.473259L17.7582 0.469567V0.467106C16.3748 -0.139664 14.1828 -0.177818 12.5742 0.485567C12.077 0.689875 11.6942 0.964336 11.2635 1.27326C10.3123 0.851893 9.28346 0.634303 8.24314 0.63449C7.2397 0.634812 6.24616 0.832978 5.31937 1.21765C4.39259 1.60233 3.55074 2.16596 2.842 2.8763C2.13325 3.58665 1.57152 4.42976 1.18894 5.35741C0.806357 6.28506 0.610432 7.27905 0.612374 8.28249C0.612374 9.2388 0.806835 10.1988 1.1416 11.1046C0.926038 11.2605 0.728328 11.4396 0.552066 11.6388L0.539758 11.656C0.350566 11.8717 0.205929 12.1228 0.114181 12.3946C0.0224335 12.6665 -0.0146117 12.9538 0.00518034 13.24C0.0249724 13.5263 0.10121 13.8058 0.229501 14.0624C0.357793 14.3191 0.535601 14.5478 0.752681 14.7354L9.13422 21.7791C9.99084 22.5225 10.9742 22.4696 12.2604 21.6966C12.4499 21.8345 12.4573 21.8542 12.5533 21.9219C13.4924 22.728 14.941 22.6788 15.7521 21.7262L16.1102 21.2979C16.3502 21.0173 16.4893 20.6899 16.5595 20.3514C17.3841 20.5594 18.237 20.3391 18.7908 19.6905L19.1551 19.2622C19.3845 18.9903 19.5412 18.6646 19.6105 18.3157C20.4339 18.525 21.2881 18.3034 21.8419 17.6548L22.2087 17.2265C22.4475 16.9471 22.5902 16.6197 22.6628 16.2813C23.4862 16.488 24.3416 16.269 24.8942 15.6203L25.261 15.1908C25.9256 14.413 25.917 13.3065 25.3558 12.4634C26.1558 11.2622 26.509 9.97357 26.509 8.28249Z" fill="#253238" />
                        </svg>
                        <p>Compras</p>
                        <div className="arrow">
                            <svg xmlns="http://www.w3.org/2000/svg" width="128" height="128" viewBox="0 0 24 24"><path fill="#000000" d="m14.475 12l-7.35-7.35q-.375-.375-.363-.888t.388-.887t.888-.375t.887.375l7.675 7.7q.3.3.45.675t.15.75t-.15.75t-.45.675l-7.7 7.7q-.375.375-.875.363T7.15 21.1t-.375-.888t.375-.887z" /></svg>
                        </div>
                    </div>
                    <div className={`menu-item ${(location.pathname === "/sales/ongoing" || location.pathname === "/sales/completed") ? "active" : ""}`} onClick={() => navigate("/sales/ongoing")}>
                        <svg width="26" height="27" viewBox="0 0 26 27" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M18.5502 7.57895C18.3268 7.57895 18.1126 7.49023 17.9547 7.3323C17.7968 7.17438 17.7081 6.96018 17.7081 6.73684C17.7081 6.5135 17.7968 6.29931 17.9547 6.14138C18.1126 5.98346 18.3268 5.89474 18.5502 5.89474C18.7735 5.89474 18.9877 5.98346 19.1456 6.14138C19.3035 6.29931 19.3923 6.5135 19.3923 6.73684C19.3923 6.96018 19.3035 7.17438 19.1456 7.3323C18.9877 7.49023 18.7735 7.57895 18.5502 7.57895ZM23.5556 10.1238C23.5547 10.2567 23.5271 10.388 23.4746 10.51C23.4221 10.6321 23.3457 10.7424 23.25 10.8345L19.3906 14.5002V9.26316C19.3906 9.21095 19.3704 9.16632 19.3611 9.11747C19.8584 8.94803 20.2903 8.62755 20.5966 8.20076C20.9029 7.77397 21.0683 7.26218 21.0697 6.73684C21.0697 6.06784 20.8044 5.42615 20.3319 4.95255C19.8594 4.47894 19.2183 4.21209 18.5493 4.21053C17.8803 4.21209 17.2393 4.47894 16.7668 4.95255C16.2943 5.42615 16.0289 6.06784 16.0289 6.73684C16.0289 7.84421 16.7481 8.77642 17.7384 9.11747C17.73 9.16632 17.7097 9.21095 17.7097 9.26316V16.0968L10.8584 22.6046C10.6735 22.7821 10.4262 22.8796 10.1699 22.8761C9.9137 22.8727 9.66913 22.7685 9.48911 22.5861L1.96742 15.0467C1.87439 14.9539 1.80102 14.8433 1.75168 14.7214C1.70235 14.5996 1.67806 14.4691 1.68027 14.3377C1.68363 14.0699 1.79227 13.8215 1.98595 13.6371L14.3396 1.92842C14.5232 1.75411 14.7624 1.68421 15.015 1.68421H15.0201L22.6074 1.70021C22.7355 1.69977 22.8625 1.72466 22.9809 1.77345C23.0994 1.82225 23.207 1.89399 23.2977 1.98454C23.3883 2.07509 23.4601 2.18267 23.509 2.30108C23.5579 2.4195 23.5829 2.54641 23.5826 2.67453L23.5556 10.1238ZM21.0697 24.4211C21.0697 24.6441 20.9813 24.858 20.8237 25.0159C20.6661 25.1738 20.4524 25.2627 20.2293 25.2632C20.0064 25.2625 19.7929 25.1735 19.6355 25.0156C19.4781 24.8578 19.3897 24.644 19.3897 24.4211V16.8202L21.0697 15.2244V24.4211ZM22.6167 0.016L15.031 0H15.0167C14.3329 0 13.6836 0.233263 13.186 0.704842L0.831424 12.4278C0.572371 12.671 0.365192 12.964 0.222354 13.2894C0.0795162 13.6147 0.00397158 13.9656 0.00026622 14.3208C-0.00983904 15.0476 0.268056 15.7272 0.780056 16.2408L8.30258 23.7785C8.82469 24.3032 9.50342 24.5651 10.183 24.5651C10.8398 24.5651 11.4967 24.3192 12.0146 23.8274L17.7106 18.416V24.4211C17.7106 25.0899 17.9758 25.7315 18.4481 26.205C18.9205 26.6786 19.5613 26.9456 20.2302 26.9474C20.8992 26.9458 21.5402 26.679 22.0127 26.2053C22.4852 25.7317 22.7506 25.0901 22.7506 24.4211V13.6278L24.4045 12.0564C24.6653 11.8079 24.8733 11.5093 25.0161 11.1785C25.1589 10.8478 25.2336 10.4916 25.2356 10.1314L25.2634 2.68126C25.2657 1.97706 24.9882 1.30077 24.4921 0.801012C23.996 0.30125 23.3217 0.0188981 22.6175 0.016H22.6167ZM10.9897 10.9474H12.6697C12.7802 10.9473 12.8896 10.9254 12.9916 10.883C13.0936 10.8406 13.1863 10.7786 13.2644 10.7004C13.3424 10.6222 13.4043 10.5294 13.4464 10.4273C13.4886 10.3252 13.5103 10.2157 13.5102 10.1053C13.5102 9.64042 13.1346 9.26316 12.6697 9.26316H11.8293V8.42105C11.8356 8.30687 11.8185 8.1926 11.7791 8.08524C11.7397 7.97788 11.6789 7.87968 11.6003 7.79663C11.5216 7.71358 11.4269 7.64743 11.3219 7.60223C11.2168 7.55702 11.1037 7.53371 10.9893 7.53371C10.875 7.53371 10.7618 7.55702 10.6568 7.60223C10.5517 7.64743 10.457 7.71358 10.3784 7.79663C10.2998 7.87968 10.2389 7.97788 10.1995 8.08524C10.1601 8.1926 10.1431 8.30687 10.1493 8.42105V9.40716C9.58725 9.60552 9.11342 9.99622 8.81159 10.5102C8.50977 11.0242 8.39939 11.6283 8.49998 12.2158C8.60056 12.8033 8.90563 13.3363 9.36125 13.7206C9.81687 14.1049 10.3937 14.3157 10.9897 14.3158C11.2131 14.3158 11.4273 14.4045 11.5852 14.5624C11.7431 14.7204 11.8318 14.9346 11.8318 15.1579C11.8318 15.3812 11.7431 15.5954 11.5852 15.7534C11.4273 15.9113 11.2131 16 10.9897 16H9.30974C9.19926 16.0001 9.08989 16.022 8.98787 16.0644C8.88584 16.1067 8.79316 16.1688 8.71512 16.247C8.63708 16.3252 8.57521 16.418 8.53303 16.5201C8.49086 16.6222 8.46921 16.7316 8.46932 16.8421C8.46932 17.3069 8.8449 17.6842 9.30974 17.6842H10.1493V18.5263C10.1458 18.6389 10.1648 18.751 10.2055 18.856C10.2461 18.961 10.3074 19.0568 10.3857 19.1377C10.4641 19.2186 10.5579 19.2829 10.6616 19.3268C10.7653 19.3707 10.8767 19.3933 10.9893 19.3933C11.1019 19.3933 11.2134 19.3707 11.3171 19.3268C11.4208 19.2829 11.5146 19.2186 11.5929 19.1377C11.6713 19.0568 11.7326 18.961 11.7732 18.856C11.8138 18.751 11.8329 18.6389 11.8293 18.5263V17.5402C12.3913 17.3419 12.8651 16.9512 13.1669 16.4374C13.4688 15.9235 13.5792 15.3194 13.4787 14.732C13.3783 14.1445 13.0733 13.6115 12.6179 13.2272C12.1624 12.8428 11.5857 12.6319 10.9897 12.6316C10.7664 12.6316 10.5522 12.5429 10.3943 12.3849C10.2364 12.227 10.1476 12.0128 10.1476 11.7895C10.1476 11.5661 10.2364 11.3519 10.3943 11.194C10.5522 11.0361 10.7664 10.9474 10.9897 10.9474Z" fill="#253238" />
                        </svg>
                        <p>Ventas</p>
                        <div className="arrow">
                            <svg xmlns="http://www.w3.org/2000/svg" width="128" height="128" viewBox="0 0 24 24"><path fill="#000000" d="m14.475 12l-7.35-7.35q-.375-.375-.363-.888t.388-.887t.888-.375t.887.375l7.675 7.7q.3.3.45.675t.15.75t-.15.75t-.45.675l-7.7 7.7q-.375.375-.875.363T7.15 21.1t-.375-.888t.375-.887z" /></svg>
                        </div>
                    </div>
                    <div className={`menu-item ${(location.pathname === "/catalog/published" || location.pathname === "/catalog/sold") ? "active" : ""}`} onClick={() => navigate("/catalog/published")}>
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M17.6 17.716L12.1152 23.2008C11.8619 23.4542 11.5611 23.6552 11.2301 23.7923C10.8991 23.9294 10.5443 24 10.186 24C9.82773 24 9.47294 23.9294 9.14193 23.7923C8.81091 23.6552 8.51015 23.4542 8.25683 23.2008L0.799226 15.744C0.545844 15.4907 0.344847 15.1899 0.207714 14.8589C0.070582 14.5279 0 14.1731 0 13.8148C0 13.4565 0.070582 13.1017 0.207714 12.7707C0.344847 12.4397 0.545844 12.1389 0.799226 11.8856L11.8848 0.7992C12.3963 0.287578 13.0902 9.94637e-05 13.8136 1.17313e-07H21.2712C21.6295 -0.00010496 21.9844 0.0703792 22.3154 0.207427C22.6465 0.344475 22.9473 0.545401 23.2007 0.79873C23.4541 1.05206 23.6551 1.35283 23.7923 1.68385C23.9294 2.01488 24 2.36969 24 2.728V10.1864C23.9999 10.9099 23.7124 11.6037 23.2008 12.1152L21.6 13.716V22C21.6 22.5304 21.3893 23.0391 21.0142 23.4142C20.6392 23.7893 20.1305 24 19.6 24C19.0696 24 18.5609 23.7893 18.1858 23.4142C17.8107 23.0391 17.6 22.5304 17.6 22V17.716ZM13.8136 1.6C13.5145 1.60001 13.2276 1.71886 13.016 1.9304L1.93043 13.016C1.82557 13.1208 1.74238 13.2452 1.68563 13.3821C1.62887 13.519 1.59966 13.6658 1.59966 13.814C1.59966 13.9622 1.62887 14.109 1.68563 14.2459C1.74238 14.3828 1.82557 14.5072 1.93043 14.612L9.38803 22.0696C9.82883 22.5096 10.5432 22.5096 10.984 22.0696L17.6 15.4536V7.8632C17.066 7.67448 16.616 7.30304 16.3293 6.81456C16.0427 6.32607 15.938 5.75198 16.0338 5.19377C16.1295 4.63556 16.4195 4.12917 16.8525 3.7641C17.2855 3.39904 17.8337 3.19881 18.4 3.19881C18.9664 3.19881 19.5145 3.39904 19.9475 3.7641C20.3805 4.12917 20.6705 4.63556 20.7663 5.19377C20.862 5.75198 20.7573 6.32607 20.4707 6.81456C20.1841 7.30304 19.734 7.67448 19.2 7.8632V13.8536L22.0696 10.984C22.2812 10.7725 22.4 10.4856 22.4 10.1864V2.728C22.4 2.42884 22.2812 2.14192 22.0696 1.93038C21.8581 1.71884 21.5712 1.6 21.272 1.6H13.8136ZM20 15.316V22C20 22.1061 19.9579 22.2078 19.8829 22.2828C19.8079 22.3579 19.7061 22.4 19.6 22.4C19.4939 22.4 19.3922 22.3579 19.3172 22.2828C19.2422 22.2078 19.2 22.1061 19.2 22V16.116L20 15.316ZM18.4 6.4C18.6122 6.4 18.8157 6.31571 18.9657 6.16569C19.1157 6.01566 19.2 5.81217 19.2 5.6C19.2 5.38783 19.1157 5.18434 18.9657 5.03431C18.8157 4.88429 18.6122 4.8 18.4 4.8C18.1879 4.8 17.9844 4.88429 17.8343 5.03431C17.6843 5.18434 17.6 5.38783 17.6 5.6C17.6 5.81217 17.6843 6.01566 17.8343 6.16569C17.9844 6.31571 18.1879 6.4 18.4 6.4Z" fill="#253238" />
                        </svg>
                        <p>Tu Catálogo</p>
                        <div className="arrow">
                            <svg xmlns="http://www.w3.org/2000/svg" width="128" height="128" viewBox="0 0 24 24"><path fill="#000000" d="m14.475 12l-7.35-7.35q-.375-.375-.363-.888t.388-.887t.888-.375t.887.375l7.675 7.7q.3.3.45.675t.15.75t-.15.75t-.45.675l-7.7 7.7q-.375.375-.875.363T7.15 21.1t-.375-.888t.375-.887z" /></svg>
                        </div>
                    </div>
                    <div className={`menu-item ${location.pathname === "/profile/chat" ? "active" : ""}`} onClick={() => navigate("/profile/chat")}>
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#29363d" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M4.26 6.95a.75.75 0 1 0-1.02 1.1l.02.018.056.052.211.193a83 83 0 0 0 3.208 2.768c.53.433 1.085.87 1.63 1.274L4 16.72a.75.75 0 1 0 1.06 1.06l4.551-4.55c.422.274.83.514 1.204.69.368.174.79.33 1.185.33.396 0 .817-.156 1.185-.33.384-.181.806-.43 1.24-.714L19 17.78a.75.75 0 1 0 1.06-1.06l-4.39-4.39a47 47 0 0 0 1.595-1.249 79 79 0 0 0 3.42-2.961l.055-.052.02-.018a.75.75 0 0 0-1.02-1.1l-.017.016-.053.049-.206.188a82 82 0 0 1-3.146 2.716c-.913.743-1.866 1.475-2.69 2.017a9.5 9.5 0 0 1-1.084.628c-.326.154-.495.186-.544.186s-.218-.032-.544-.186a9 9 0 0 1-1.083-.628c-.826-.542-1.778-1.274-2.69-2.017A78 78 0 0 1 4.33 7.015l-.054-.049z"></path><path fill-rule="evenodd" d="M12 1.5C-.123 1.5-.074 4.563.014 10.097c.008.49.016 1 .016 1.528l-.002.884C0 18.514-.018 22.5 12 22.5s12-3.986 11.973-9.99q-.003-.436-.003-.885.002-.793.016-1.528C24.074 4.563 24.123 1.5 12 1.5M1.53 11.625c0-.595-.009-1.137-.017-1.64-.016-.97-.029-1.793.028-2.573.082-1.131.303-1.844.707-2.362.397-.507 1.133-1.034 2.683-1.427C6.495 3.226 8.75 3 12 3s5.505.226 7.069.623c1.55.393 2.286.92 2.683 1.427.404.518.625 1.23.707 2.362.057.78.044 1.604.028 2.573-.008.503-.017 1.045-.017 1.64l.002.925c.006 1.278.01 2.367-.093 3.359-.124 1.194-.392 2.046-.873 2.694C20.563 19.871 18.283 21 12 21s-8.563-1.129-9.505-2.397c-.482-.648-.75-1.5-.874-2.694-.104-.992-.099-2.08-.093-3.358z" clip-rule="evenodd"></path></svg>
                        <p>Buzón</p>
                        <div className="arrow">
                            <svg xmlns="http://www.w3.org/2000/svg" width="128" height="128" viewBox="0 0 24 24"><path fill="#000000" d="m14.475 12l-7.35-7.35q-.375-.375-.363-.888t.388-.887t.888-.375t.887.375l7.675 7.7q.3.3.45.675t.15.75t-.15.75t-.45.675l-7.7 7.7q-.375.375-.875.363T7.15 21.1t-.375-.888t.375-.887z" /></svg>
                        </div>
                    </div>
                    <div className={`menu-item ${(location.pathname === "/favorites/products" || location.pathname === "/favorites/profiles") ? "active" : ""}`} onClick={() => navigate("/favorites/products")}>
                        <svg width="28" height="25" viewBox="0 0 28 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M24.1434 12.9098L13.5184 23.4328L2.89341 12.9098C2.19259 12.2279 1.64057 11.4082 1.2721 10.5024C0.903637 9.59661 0.726707 8.62434 0.752456 7.64682C0.778205 6.66929 1.00608 5.70769 1.42172 4.82255C1.83736 3.93742 2.43177 3.14794 3.16752 2.50381C3.90326 1.85969 4.76441 1.37489 5.69673 1.07992C6.62904 0.784964 7.61234 0.686238 8.58468 0.789962C9.55703 0.893687 10.4974 1.19762 11.3465 1.68261C12.1956 2.16761 12.9351 2.82316 13.5184 3.60799C14.1043 2.82886 14.8446 2.17903 15.6931 1.69918C16.5417 1.21934 17.4801 0.919797 18.4497 0.819314C19.4194 0.71883 20.3993 0.819566 21.3282 1.11522C22.2571 1.41086 23.1149 1.89506 23.8481 2.53751C24.5813 3.17995 25.1739 3.96681 25.589 4.84884C26.0041 5.73087 26.2326 6.68908 26.2603 7.6635C26.2881 8.63792 26.1144 9.60757 25.7501 10.5118C25.3858 11.416 24.8389 12.2352 24.1434 12.9183" stroke="#253238" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        <p>Favoritos</p>
                        <div className="arrow">
                            <svg xmlns="http://www.w3.org/2000/svg" width="128" height="128" viewBox="0 0 24 24"><path fill="#000000" d="m14.475 12l-7.35-7.35q-.375-.375-.363-.888t.388-.887t.888-.375t.887.375l7.675 7.7q.3.3.45.675t.15.75t-.15.75t-.45.675l-7.7 7.7q-.375.375-.875.363T7.15 21.1t-.375-.888t.375-.887z" /></svg>
                        </div>
                    </div>
                    <div
                        className={`menu-item hide-mobile ${location.pathname === "/profile/stats" ? "active" : ""}`}
                        onClick={() => navigate("/profile/stats")}>
                        <svg width="26" height="26" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M16 24H17.6V2.4C17.6 1.76348 17.8529 1.15303 18.3029 0.702944C18.753 0.252856 19.3635 0 20 0H21.6C22.2365 0 22.847 0.252856 23.2971 0.702944C23.7471 1.15303 24 1.76348 24 2.4V24H24.8C25.0122 24 25.2157 24.0843 25.3657 24.2343C25.5157 24.3843 25.6 24.5878 25.6 24.8C25.6 25.0122 25.5157 25.2157 25.3657 25.3657C25.2157 25.5157 25.0122 25.6 24.8 25.6H0.8C0.587827 25.6 0.384344 25.5157 0.234315 25.3657C0.0842856 25.2157 0 25.0122 0 24.8C0 24.5878 0.0842856 24.3843 0.234315 24.2343C0.384344 24.0843 0.587827 24 0.8 24H1.6V13.6C1.6 12.9635 1.85286 12.353 2.30294 11.9029C2.75303 11.4529 3.36348 11.2 4 11.2H5.6C6.23652 11.2 6.84697 11.4529 7.29706 11.9029C7.74714 12.353 8 12.9635 8 13.6V24H9.6V19.2C9.6 18.5635 9.85286 17.953 10.3029 17.5029C10.753 17.0529 11.3635 16.8 12 16.8H13.6C14.2365 16.8 14.847 17.0529 15.2971 17.5029C15.7471 17.953 16 18.5635 16 19.2V24ZM20 1.6C19.7878 1.6 19.5843 1.68429 19.4343 1.83431C19.2843 1.98434 19.2 2.18783 19.2 2.4V24H22.4V2.4C22.4 2.18783 22.3157 1.98434 22.1657 1.83431C22.0157 1.68429 21.8122 1.6 21.6 1.6H20ZM14.4 24V19.2C14.4 18.9878 14.3157 18.7843 14.1657 18.6343C14.0157 18.4843 13.8122 18.4 13.6 18.4H12C11.7878 18.4 11.5843 18.4843 11.4343 18.6343C11.2843 18.7843 11.2 18.9878 11.2 19.2V24H14.4ZM3.2 13.6C3.2 13.3878 3.28429 13.1843 3.43431 13.0343C3.58434 12.8843 3.78783 12.8 4 12.8H5.6C5.81217 12.8 6.01566 12.8843 6.16569 13.0343C6.31571 13.1843 6.4 13.3878 6.4 13.6V24H3.2V13.6Z" fill="#253238" />
                        </svg>
                        <p>Estadísticas</p>
                        <div className="arrow">
                            <svg xmlns="http://www.w3.org/2000/svg" width="128" height="128" viewBox="0 0 24 24"><path fill="#000000" d="m14.475 12l-7.35-7.35q-.375-.375-.363-.888t.388-.887t.888-.375t.887.375l7.675 7.7q.3.3.45.675t.15.75t-.15.75t-.45.675l-7.7 7.7q-.375.375-.875.363T7.15 21.1t-.375-.888t.375-.887z" /></svg>
                        </div>
                    </div>
                    <div className={`menu-item ${location.pathname === "/profile/wallet" ? "active" : ""}`} onClick={() => navigate("/profile/wallet")}>
                        <svg width="26" height="25" viewBox="0 0 26 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M20.2984 0.0574846C20.4035 0.0997127 20.4984 0.163766 20.5769 0.245409C20.6553 0.327052 20.7156 0.424423 20.7536 0.531085L22.6096 5.72869C23.466 5.95236 24.2241 6.45367 24.7652 7.15415C25.3063 7.85463 25.5999 8.71475 25.6 9.59988V20.7999C25.6 21.8608 25.1786 22.8782 24.4284 23.6283C23.6783 24.3785 22.6609 24.7999 21.6 24.7999H4C2.93913 24.7999 1.92172 24.3785 1.17157 23.6283C0.421427 22.8782 0 21.8608 0 20.7999V9.59988C5.64328e-05 8.77992 0.252006 7.97976 0.721755 7.30769C1.1915 6.63562 1.85638 6.12408 2.6264 5.84229C2.66124 5.80577 2.69986 5.77306 2.7416 5.74468L10.7416 0.144685C10.8305 0.0824772 10.9312 0.0390102 11.0374 0.0169291C11.1437 -0.00515208 11.2533 -0.00538591 11.3596 0.0162417C11.466 0.0378692 11.5668 0.0809059 11.656 0.142734C11.7452 0.204561 11.8208 0.283887 11.8784 0.375884L13.588 3.11188L19.6424 0.0846846C19.7436 0.0340052 19.8544 0.00537562 19.9675 0.000686847C20.0806 -0.00400193 20.1934 0.0153569 20.2984 0.0574846ZM12.1504 3.83028L10.9688 1.93828L5.7376 5.59988H8.6104L12.1504 3.83028ZM19.5504 1.91908L20.8648 5.59988H12.1888L19.5504 1.91908ZM8.8176 7.19988C8.8064 7.20013 8.7952 7.20013 8.784 7.19988H4C3.36348 7.19988 2.75303 7.45274 2.30294 7.90283C1.85286 8.35292 1.6 8.96337 1.6 9.59988V20.7999C1.6 21.4364 1.85286 22.0469 2.30294 22.4969C2.75303 22.947 3.36348 23.1999 4 23.1999H21.6C22.2365 23.1999 22.847 22.947 23.2971 22.4969C23.7471 22.0469 24 21.4364 24 20.7999V19.1999H18.4C17.5513 19.1999 16.7374 18.8627 16.1373 18.2626C15.5371 17.6625 15.2 16.8486 15.2 15.9999C15.2 15.1512 15.5371 14.3373 16.1373 13.7371C16.7374 13.137 17.5513 12.7999 18.4 12.7999H24V9.59988C24 8.96337 23.7471 8.35292 23.2971 7.90283C22.847 7.45274 22.2365 7.19988 21.6 7.19988H8.8176ZM18.4 14.3999H24V17.5999H18.4C17.9757 17.5999 17.5687 17.4313 17.2686 17.1313C16.9686 16.8312 16.8 16.4242 16.8 15.9999C16.8 15.5755 16.9686 15.1686 17.2686 14.8685C17.5687 14.5685 17.9757 14.3999 18.4 14.3999Z" fill="#253238" />
                        </svg>
                        <p>Monedero</p>
                        <div className="arrow">
                            <svg xmlns="http://www.w3.org/2000/svg" width="128" height="128" viewBox="0 0 24 24"><path fill="#000000" d="m14.475 12l-7.35-7.35q-.375-.375-.363-.888t.388-.887t.888-.375t.887.375l7.675 7.7q.3.3.45.675t.15.75t-.15.75t-.45.675l-7.7 7.7q-.375.375-.875.363T7.15 21.1t-.375-.888t.375-.887z" /></svg>
                        </div>
                    </div>
                    <div className='menu-item' >
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M9.90625 2.39625C10.4387 0.20125 13.5613 0.20125 14.0938 2.39625C14.1736 2.726 14.3303 3.03222 14.5509 3.29C14.7715 3.54778 15.0499 3.74982 15.3633 3.87968C15.6768 4.00955 16.0165 4.06356 16.3547 4.03734C16.693 4.01111 17.0203 3.90538 17.31 3.72875C19.2387 2.55375 21.4475 4.76125 20.2725 6.69125C20.0961 6.98082 19.9906 7.30792 19.9644 7.64597C19.9382 7.98401 19.9922 8.32346 20.1219 8.63672C20.2516 8.94999 20.4534 9.22822 20.7109 9.44882C20.9684 9.66941 21.2743 9.82613 21.6038 9.90625C23.7988 10.4387 23.7988 13.5613 21.6038 14.0938C21.274 14.1736 20.9678 14.3303 20.71 14.5509C20.4522 14.7715 20.2502 15.0499 20.1203 15.3633C19.9905 15.6768 19.9364 16.0165 19.9627 16.3547C19.9889 16.693 20.0946 17.0203 20.2713 17.31C21.4463 19.2387 19.2387 21.4475 17.3087 20.2725C17.0192 20.0961 16.6921 19.9906 16.354 19.9644C16.016 19.9382 15.6765 19.9922 15.3633 20.1219C15.05 20.2516 14.7718 20.4534 14.5512 20.7109C14.3306 20.9684 14.1739 21.2743 14.0938 21.6038C13.5613 23.7988 10.4387 23.7988 9.90625 21.6038C9.82635 21.274 9.66972 20.9678 9.44911 20.71C9.2285 20.4522 8.95014 20.2502 8.63669 20.1203C8.32323 19.9905 7.98354 19.9364 7.64527 19.9627C7.30699 19.9889 6.97969 20.0946 6.69 20.2713C4.76125 21.4463 2.5525 19.2387 3.7275 17.3087C3.90388 17.0192 4.00944 16.6921 4.0356 16.354C4.06177 16.016 4.0078 15.6765 3.87809 15.3633C3.74838 15.05 3.54658 14.7718 3.28909 14.5512C3.03161 14.3306 2.7257 14.1739 2.39625 14.0938C0.20125 13.5613 0.20125 10.4387 2.39625 9.90625C2.726 9.82635 3.03222 9.66972 3.29 9.44911C3.54778 9.2285 3.74982 8.95014 3.87968 8.63669C4.00955 8.32323 4.06356 7.98354 4.03734 7.64527C4.01111 7.30699 3.90538 6.97969 3.72875 6.69C2.55375 4.76125 4.76125 2.5525 6.69125 3.7275C7.94125 4.4875 9.56125 3.815 9.90625 2.39625Z" stroke="#253238" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                            <path d="M8.25 12C8.25 12.9946 8.64509 13.9484 9.34835 14.6517C10.0516 15.3549 11.0054 15.75 12 15.75C12.9946 15.75 13.9484 15.3549 14.6517 14.6517C15.3549 13.9484 15.75 12.9946 15.75 12C15.75 11.0054 15.3549 10.0516 14.6517 9.34835C13.9484 8.64509 12.9946 8.25 12 8.25C11.0054 8.25 10.0516 8.64509 9.34835 9.34835C8.64509 10.0516 8.25 11.0054 8.25 12Z" stroke="#253238" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        <p>Configuración</p>
                        <div className="arrow">
                            <svg xmlns="http://www.w3.org/2000/svg" width="128" height="128" viewBox="0 0 24 24"><path fill="#000000" d="m14.475 12l-7.35-7.35q-.375-.375-.363-.888t.388-.887t.888-.375t.887.375l7.675 7.7q.3.3.45.675t.15.75t-.15.75t-.45.675l-7.7 7.7q-.375.375-.875.363T7.15 21.1t-.375-.888t.375-.887z" /></svg>
                        </div>
                    </div>
                    <div className='menu-item'>
                        <svg width="26" height="26" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12.7996 16.8C13.0118 16.8 13.2153 16.8843 13.3653 17.0343C13.5154 17.1843 13.5996 17.3878 13.5996 17.6V18.4C13.5996 18.6122 13.5154 18.8156 13.3653 18.9657C13.2153 19.1157 13.0118 19.2 12.7996 19.2C12.5875 19.2 12.384 19.1157 12.234 18.9657C12.0839 18.8156 11.9996 18.6122 11.9996 18.4V17.6C11.9996 17.3878 12.0839 17.1843 12.234 17.0343C12.384 16.8843 12.5875 16.8 12.7996 16.8ZM15.042 7.14878C14.4284 6.58078 13.6396 6.36238 12.7748 6.40478C11.9605 6.42283 11.1838 6.7507 10.6028 7.32158L10.5948 7.32958L10.5868 7.33758C10.052 7.89927 9.70896 8.61597 9.60684 9.38478C9.58046 9.59457 9.6382 9.80628 9.76745 9.97362C9.8967 10.141 10.0869 10.2503 10.2966 10.2778C10.5062 10.3053 10.7182 10.2487 10.8863 10.1203C11.0543 9.99194 11.1646 9.80228 11.1932 9.59278C11.2509 9.16294 11.4423 8.76214 11.7404 8.44718C11.8764 8.31358 12.0396 8.20478 12.2228 8.12878C12.4114 8.05026 12.6131 8.00819 12.8172 8.00478H12.8316L12.846 8.00398C13.3852 7.97518 13.7196 8.10798 13.9484 8.31758C14.2324 8.59438 14.3868 8.95838 14.3916 9.33198V9.36078L14.394 9.38958C14.414 9.62398 14.3796 9.86158 14.2932 10.0832C14.1888 10.3202 14.0544 10.5428 13.8932 10.7456L13.8924 10.7472C13.7042 10.985 13.5002 11.2101 13.282 11.4208L13.2764 11.4272C13.0172 11.6832 12.774 11.9536 12.5468 12.2368C12.4354 12.3761 12.3436 12.5301 12.274 12.6944C12.0476 13.2192 12.0028 13.768 12.002 14.2224L11.9996 15.1976C11.9992 15.4098 12.0831 15.6134 12.2328 15.7637C12.3826 15.9141 12.5859 15.9988 12.798 15.9992C13.0102 15.9996 13.2139 15.9157 13.3642 15.766C13.5145 15.6163 13.5992 15.413 13.5996 15.2008L13.602 14.2248C13.6028 13.8552 13.6428 13.5592 13.7428 13.3272C13.7551 13.2959 13.7718 13.2665 13.7924 13.24L13.7956 13.236C13.9828 13.0024 14.1836 12.7792 14.398 12.5672C14.666 12.3072 14.9164 12.0312 15.1468 11.7392C15.398 11.4232 15.606 11.0768 15.766 10.708L15.7716 10.6968L15.7756 10.6848C15.9529 10.2403 16.0268 9.76125 15.9916 9.28398C15.9722 8.47964 15.6351 7.7157 15.054 7.15918L15.0476 7.15358L15.042 7.14878Z" fill="#253238" />
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M0 12.8C0 5.7304 5.7304 0 12.8 0C19.8696 0 25.6 5.7304 25.6 12.8C25.6 19.8696 19.8696 25.6 12.8 25.6C5.7304 25.6 0 19.8696 0 12.8ZM12.8 1.6C6.6144 1.6 1.6 6.6144 1.6 12.8C1.6 18.9856 6.6144 24 12.8 24C18.9856 24 24 18.9856 24 12.8C24 6.6144 18.9856 1.6 12.8 1.6Z" fill="#253238" />
                        </svg>
                        <p>Ayuda</p>
                        <div className="arrow">
                            <svg xmlns="http://www.w3.org/2000/svg" width="128" height="128" viewBox="0 0 24 24"><path fill="#000000" d="m14.475 12l-7.35-7.35q-.375-.375-.363-.888t.388-.887t.888-.375t.887.375l7.675 7.7q.3.3.45.675t.15.75t-.15.75t-.45.675l-7.7 7.7q-.375.375-.875.363T7.15 21.1t-.375-.888t.375-.887z" /></svg>
                        </div>
                    </div>
                    <div className='menu-item hide-mobile'>
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M11.7 12.4C11.7 9.6 13.8 10.3 13.8 8.2C13.8 7.28125 13.1 6.1 11.7 6.1C10.3 6.1 9.6 6.8 8.9 7.5M11.7 16.6V14.5M22.9 11.7C22.9 17.8856 17.8856 22.9 11.7 22.9C5.51441 22.9 0.5 17.8856 0.5 11.7C0.5 5.51441 5.51441 0.5 11.7 0.5C17.8856 0.5 22.9 5.51441 22.9 11.7Z" stroke="#898989" />
                        </svg>
                        <p>Preguntas Frecuentes</p>
                        <div className="arrow">
                            <svg xmlns="http://www.w3.org/2000/svg" width="128" height="128" viewBox="0 0 24 24"><path fill="#000000" d="m14.475 12l-7.35-7.35q-.375-.375-.363-.888t.388-.887t.888-.375t.887.375l7.675 7.7q.3.3.45.675t.15.75t-.15.75t-.45.675l-7.7 7.7q-.375.375-.875.363T7.15 21.1t-.375-.888t.375-.887z" /></svg>
                        </div>
                    </div>
                </div>
            </div>
        </>
    )
}